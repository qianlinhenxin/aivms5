<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qlhx.dao.ArchivesMapper">
	<resultMap id="BaseResultMap" type="com.qlhx.model.Archives">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="archivesId" property="archivesid" jdbcType="INTEGER" />
		<result column="YT" property="yt" jdbcType="VARCHAR" />
		<result column="status" property="status" jdbcType="INTEGER" />
		<result column="userId" property="userid" jdbcType="INTEGER" />
		<result column="recordTime" property="recordtime" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		archivesId, YT, status, userId, recordTime
	</sql>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from u_archives
		where archivesId = #{archivesid,jdbcType=INTEGER}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from u_archives
		where archivesId =
		#{archivesid,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.qlhx.model.Archives">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into u_archives (archivesId, YT, status,
		userId, recordTime)
		values (#{archivesid,jdbcType=INTEGER}, #{yt,jdbcType=VARCHAR},
		#{status,jdbcType=INTEGER},
		#{userid,jdbcType=INTEGER},
		#{recordtime,jdbcType=VARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.qlhx.model.Archives">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into u_archives
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="archivesid != null">
				archivesId,
			</if>
			<if test="yt != null">
				YT,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="userid != null">
				userId,
			</if>
			<if test="recordtime != null">
				recordTime,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="archivesid != null">
				#{archivesid,jdbcType=INTEGER},
			</if>
			<if test="yt != null">
				#{yt,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				#{status,jdbcType=INTEGER},
			</if>
			<if test="userid != null">
				#{userid,jdbcType=INTEGER},
			</if>
			<if test="recordtime != null">
				#{recordtime,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.qlhx.model.Archives">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update u_archives
		<set>
			<if test="yt != null">
				YT = #{yt,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				status = #{status,jdbcType=INTEGER},
			</if>
			<if test="userid != null">
				userId = #{userid,jdbcType=INTEGER},
			</if>
			<if test="recordtime != null">
				recordTime = #{recordtime,jdbcType=VARCHAR},
			</if>
		</set>
		where archivesId = #{archivesid,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.qlhx.model.Archives">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update u_archives
		set YT = #{yt,jdbcType=VARCHAR},
		status =
		#{status,jdbcType=INTEGER},
		userId = #{userid,jdbcType=INTEGER},
		recordTime = #{recordtime,jdbcType=VARCHAR}
		where archivesId =
		#{archivesid,jdbcType=INTEGER}
	</update>
	<select id="getArchivesByYT" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from u_archives
		where YT = #{YT,jdbcType=VARCHAR} AND status= #{status}
	</select>

	<!-- 根据年月查询归档信息 -->
	<select id="findArchivesByYT" resultType="com.qlhx.model.Archives">
		SELECT * FROM
		u_archives WHERE YT=#{yt}
	</select>

	<!-- 查询考勤归档信息列表 -->
	<select id="findArchivesList" resultMap="arMap">
		SELECT ar.*,u.nickname FROM u_archives ar LEFT JOIN u_user u ON
		ar.userId=u.id WHERE
		<if test="month == null">
			LEFT(ar.YT,4)='${year}'
		</if>
		<if test="month != null">
			ar.YT='${year}-${month}'
		</if>
		LIMIT
		${(num-1)*recordNum},${recordNum}
	</select>

	<resultMap id="arMap" type="com.qlhx.model.Archives"
		extends="BaseResultMap">
		<!-- 归档人 -->
		<association property="user" column="userId"
			resultMap="com.qlhx.dao.UUserMapper.BaseResultMap"></association>
	</resultMap>

	<!-- 考勤归档信息列表记录数 -->
	<select id="archivesCountNum" resultType="java.lang.Integer">
		SELECT count(0) FROM u_archives ar LEFT JOIN u_user u ON
		ar.userId=u.id WHERE
		<if test="month == null">
			LEFT(ar.YT,4)='${year}'
		</if>
		<if test="month != null">
			ar.YT='${year}-${month}'
		</if>
	</select>

</mapper>